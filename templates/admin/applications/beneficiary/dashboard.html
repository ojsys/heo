{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}
<h1>Beneficiary Dashboard</h1>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center;">
        <h3 style="margin: 0; color: #666;">Total Beneficiaries</h3>
        <p style="font-size: 36px; font-weight: bold; margin: 10px 0; color: #2c5282;">{{ total_beneficiaries }}</p>
    </div>

    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center;">
        <h3 style="margin: 0; color: #666;">Active</h3>
        <p style="font-size: 36px; font-weight: bold; margin: 10px 0; color: #38a169;">{{ active_beneficiaries }}</p>
    </div>

    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center;">
        <h3 style="margin: 0; color: #666;">Total Disbursed</h3>
        <p style="font-size: 24px; font-weight: bold; margin: 10px 0; color: #dd6b20;">â‚¦{{ total_disbursed|floatformat:0 }}</p>
    </div>
</div>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
    <div>
        <h2>By Type</h2>
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #f8f9fa;">
                    <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">Type</th>
                    <th style="padding: 10px; text-align: right; border-bottom: 2px solid #dee2e6;">Count</th>
                </tr>
            </thead>
            <tbody>
                {% for item in by_type %}
                <tr>
                    <td style="padding: 10px; border-bottom: 1px solid #dee2e6;">
                        {% if item.beneficiary_type == 'education' %}Education/Scholarship
                        {% elif item.beneficiary_type == 'health' %}Healthcare
                        {% elif item.beneficiary_type == 'youth' %}Youth Empowerment
                        {% elif item.beneficiary_type == 'housing' %}Housing Support
                        {% else %}{{ item.beneficiary_type }}{% endif %}
                    </td>
                    <td style="padding: 10px; text-align: right; border-bottom: 1px solid #dee2e6; font-weight: bold;">{{ item.count }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="2" style="padding: 10px; text-align: center;">No beneficiaries yet</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div>
        <h2>Recent Beneficiaries</h2>
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #f8f9fa;">
                    <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">Name</th>
                    <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">Type</th>
                    <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">Date</th>
                </tr>
            </thead>
            <tbody>
                {% for beneficiary in recent_beneficiaries %}
                <tr>
                    <td style="padding: 10px; border-bottom: 1px solid #dee2e6;">
                        <a href="{% url 'admin:applications_beneficiary_change' beneficiary.pk %}">{{ beneficiary.full_name }}</a>
                    </td>
                    <td style="padding: 10px; border-bottom: 1px solid #dee2e6;">{{ beneficiary.get_beneficiary_type_display }}</td>
                    <td style="padding: 10px; border-bottom: 1px solid #dee2e6;">{{ beneficiary.created_at|date:"M d, Y" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="3" style="padding: 10px; text-align: center;">No beneficiaries yet</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div style="margin-top: 30px;">
    <a href="{% url 'admin:applications_beneficiary_changelist' %}" class="button" style="padding: 10px 20px; background: #417690; color: white; text-decoration: none; border-radius: 4px;">View All Beneficiaries</a>
    <a href="{% url 'admin:beneficiary_bulk_upload' %}" class="button" style="padding: 10px 20px; background: #38a169; color: white; text-decoration: none; border-radius: 4px; margin-left: 10px;">Bulk Upload</a>
</div>
{% endblock %}
